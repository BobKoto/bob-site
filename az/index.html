<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="Permissions-Policy" content="interest-cohort=(), user-id=()" />
    <meta name="description" content="Arcade game built with Unity and implemented as a PWA (Progressive Web App). Learn.">
    <link rel="manifest" href="azmanifest.json" />
    <link rel = "icon" href="intericon.png" />
   <!-- <link rel = "icon" href="intericon256.png" />   this errors out -->
   <style> 
    .ENTERSTYLE { 
        background-color: lightblue; 
        border: 2px solid black; 
        color: green; 
        padding: 5px 10px; 
        text-align: center; 
        display: inline-block; 
        font-size: 20px; 
        margin: 10px 30px; 
        cursor: pointer; 
    } 
</style> 
    <style>
      .toggle-section {
          display: block;
          margin: 20px;
          padding: 10px;
          border: none;
         /* border: 1px solid #ccc;*/
      }
  </style>
  <style>
    body {
      background-color: black;
      color: greenyellow;
      text-align: center; /* Center text horizontally */
      padding: 20px; /* Add padding for better visual appeal */
    }
      body {                              /*h1, h2, h3, div, p, a, button */
        text-align: left;                /* Align text to the left within these elements */
    }
</style>
<style>
    .buttonA {
        margin-left: 10px;
        border: 2px solid lightblue; 
    }

    .buttonB {
        margin-left: 25px;
    }
</style>
<title>Hello PWA</title>
</head>
<body>
    <h1>Intercept Arcade Game</h1>
    <!-- *****The Local VERSION to update***** -->
    <div id="message-container"></div> <p> Local VERSION a083</p><br> <!-- Change the SW too!!!-->
    <h3>Local Time: <span id="localTime"></span></h3>
    <a href='https://bobkoto.github.io/bob-site/az/game01/index.html'> <!-- starts the Unity Game -->
             <button class="buttonA">  
             <img src="rungamebutton.png" alt="Run game Button Image" width="100" height="100"> <!-- style="border: lightblue;">    -->
             </button> 
     </a> 
     <br>
    <div class="toggle-section" id="installPromptSection" style="display: none;" style="border: none;">  
    <p><strong>You can install this game/page to your device. <br>
     Then you can use it even if you're not connected to the internet. </strong></p>
     <strong> INSTALL so I can use when not connected to the internet      .</strong>   <br>
     <button id="installButton" type="button" class = "buttonA" background-color: lightblue;">
           <img src="installbutton.png" alt="Install Button Image" width="50" height="50">
     </button>
     <br><br><br>
     <strong> Not now I'll use this App connected to the internet          .</strong>   <br>
     <button id="notNowButton" type="button" class= "buttonA" background-color: lightblue;">
        <img src="notnowbutton.png" alt="Not Now Button Image" width="50" height="50">
     </button>
   </div> 

   <script src="RegisterServiceWorker.js"></script>  
 
  <script>
      function hideInstallPromptSection() {
          var section = document.getElementById('installPromptSection');
          section.style.display = 'none';
          console.log('HIDE PWA install prompt');
      }
  </script>
    <script>
      function showInstallPromptSection() {
          var section = document.getElementById('installPromptSection');
          section.style.display = 'block';
          console.log('SHOW PWA install prompt');
      }
  </script>

    <script>
        // Function to update the displayed time
        function updateTime() {
            var currentTime = new Date();
            var hours = currentTime.getHours();
            var minutes = currentTime.getMinutes();
            var seconds = currentTime.getSeconds();
            // Add leading zero if needed
            hours = (hours < 10 ? "0" : "") + hours;
            minutes = (minutes < 10 ? "0" : "") + minutes;
            seconds = (seconds < 10 ? "0" : "") + seconds;
    
            // Display the time in the "localTime" element
            document.getElementById("localTime").innerHTML = hours + ":" + minutes + ":" + seconds;
        }
        // Call updateTime initially when the page loads or is refreshed
        updateTime();
    </script>

<script>
  let deferredPrompt;
  // Check if the app is already installed (runs when the page loads)
  if (window.matchMedia('(display-mode: standalone)').matches) {
    hideInstallPromptSection();
    console.log('display-mode = standalone so we are in PWA');
   }
  else {
  console.log('display-mode is NOT standalone so we are online and NOT PWA. Proceed with addListener for beforeinstallprompt for PWA');
  window.addEventListener('beforeinstallprompt', (event) => {
    // Prevent the default behavior and Stash the event in deferredPrompt so it can be triggered later.
    event.preventDefault();
    deferredPrompt = event;
    // Show the install button or take any other action  
    if (deferredPrompt) showInstallPromptSection();  //or leave custom prompt hidden & just let the app run on the web - cuz it may already be installed
    console.log('the deferred prompt INSIDE the addEventListener block is ', deferredPrompt);
  });
  console.log('the deferred prompt OUTSIDE the addEventListener for beforeinstallprompt block is ', deferredPrompt, ' now listen on the installButton');
  document.getElementById('installButton').addEventListener('click', () => {
    // Show the installation prompt
    if (deferredPrompt) {
      deferredPrompt.prompt();
      // Wait for the user to respond to the prompt
      deferredPrompt.userChoice.then((choiceResult) => {
        if (choiceResult.outcome === 'accepted') {
          console.log('User accepted the install prompt');
          // Hide the install button after successful installation
          hideInstallPromptSection();
        } else {
          console.log('User dismissed the install prompt');
          hideInstallPromptSection();
         // document.getElementById('notNowButton').style.display = 'none';
        }
        // Reset the deferredPrompt
        deferredPrompt = null;
      });
    }
  });
// Check if the app is already installed (runs when the page loads)
//  if (window.matchMedia('(display-mode: standalone)').matches) {
//    //document.getElementById('installButton').style.display = 'none';
//    hideInstallPromptSection();
  }
</script>

    <script>
    document.getElementById('notNowButton').addEventListener('click', () => {
        console.log('User clicked notNow ');
        hideInstallPromptSection();
      //  <!--document.getElementById('notNowButton').style.display = 'none';
      //  document.getElementById('installButton').style.display = 'none';  -->
      });
      </script>

<!--   <script>
    document.getElementById('enterButton').addEventListener('click', () => {
        console.log('User pressed ****ENTER****');
      });
      </script> -->
</body>

</html>