<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="Permissions-Policy" content="interest-cohort=(), user-id=()" />
    <meta name="description" content="Arcade game built with Unity and implemented as a PWA (Progressive Web App). Learn.">
    <link rel="manifest" href="azmanifest.json" />
    <link rel = "icon" href="intericon.png" />
   <!-- <link rel = "icon" href="intericon256.png" />   this errors out -->
   <style> 
    .ENTERSTYLE { 
        background-color: lightblue; 
        border: 2px solid black; 
        color: green; 
        padding: 5px 10px; 
        text-align: center; 
        display: inline-block; 
        font-size: 20px; 
        margin: 10px 30px; 
        cursor: pointer; 
    } 
</style> 
    <style>
      .toggle-section {
          display: block;
          margin: 20px;
          padding: 10px;
          border: none;
         /* border: 1px solid #ccc;*/
      }
  </style>
  <style>
    body {
      font: 400 16px/1.5 -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
      color: #111;
      background-color: #fdfdfd;
      -webkit-text-size-adjust: 100%;
      -webkit-font-feature-settings: "kern" 1;
      -moz-font-feature-settings: "kern" 1;
      -o-font-feature-settings: "kern" 1;
      font-feature-settings: "kern" 1;
      font-kerning: normal;
      display: flex;
      min-height: 100vh;
      align-items: center;
      flex-direction: column
    }
  
    body {
      background-color: black;
      color: greenyellow;
      text-align: center;
      /* Center text horizontally */
      padding: 20px;
      /* Add padding for better visual appeal */
    }
  
    body {
      /*h1, h2, h3, div, p, a, button */
      text-align: left;
      /* Align text to the left within these elements */
    }
  </style>
<style>
    .buttonA {
        margin-left: 10px;
        border: 2px solid lightblue; 
    }

    .buttonB {
        margin-left: 25px;
    }
</style>
<style>
  .dialogstyleOLD {
     background-color: rgb(75, 70, 70);
      color: greenyellow;
      margin-top: 75px; /* An absolute length */
      margin-bottom: 75px;
      min-height: 100vh;
      width: 300px;
      height: 300px;
      overflow-y: auto; /* Enable vertical scrolling */
      align-items: center
  }
</style>
<style>
  /* Style for the modal */
  .dialogstyle {
      position: fixed;
      z-index: 1;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto; /* Enable scrolling for the entire modal */
      background-color: rgb(0, 0, 0); /* Semi-transparent background */
  }

  /* Style for the modal content */
  .dialog-content {
      background-color: rgb(75, 70, 70);
      color: greenyellow;
      margin: 15% auto;
      padding: 20px;
      border: 1px solid #888;
      width: 80%;
      max-width: 600px; /* Limit the maximum width of the modal */
      max-height: 80%; /* Limit the maximum height of the modal */
      overflow-y: auto; /* Enable vertical scrolling for the modal content */
  }
</style>
<title>Hello PWA</title>
</head>
<body>
    <h1>Interception Arcade Game</h1>
    <!-- ***********************The Local VERSION to update*********************** -->
    <div id="message-container"></div> <p> Local VERSION b028</p><br> <!-- Change the SW too!!!-->
    <h2>Local Time: <span id="localTime"></span></h2>
    <a href='https://bobkoto.github.io/bob-site/az/game01/index.html'> <!-- starts the Unity Game -->
             <button class="buttonA">  
             <img src="rungamebutton.png" alt="Run game Button Image" width="100" height="100"> <!-- style="border: lightblue;">    -->
             </button> 
     </a> 
     <br>

  <dialog id="about-dialog" class="dialogstyle"> <!--class="dialogstyle"> -->
    <div class="screenshot"></div>    <!-- not used? -->
  
    <section class="dialog-content">
      <h1>Interception Arcade Game</h1>
      <img class="logo" src="https://bobkoto.github.io/bob-site/az/CubeTestPlaying1280x720.png"
        style="height:75; width:75%; justify-content:center; align-items:center" alt="Game Screen Shot" />
      <p>
        Deceptively simple casual arcade game. Move the green bubble character to intercept on-rushing spheres.
      </p>
      <p>
        The game challenges your reflexes, your pattern matching
        skill, and your patience!
      </p>
      <p>
        When do you stay still or move around to intercept more
        spheres? You'll need to figure that out!
      </p>
      <p>
        You can install this app and play it offline or just play it 
        online;
      </p>
      <p> The Install app button will install this app on your computer or phone so
        you can play offline without any connection to the internet.
        Or you can click the Close button to play only while connected to the internet.
      </p>
    <form class="actions" method="dialog">
      <button value="cancel">Close</button>
      <button value="install" id="install-button">Install app</button>
    </form>
   </section>   
  </dialog>

   <script src="RegisterServiceWorker.js"></script>  
 
  <script>
      function hideInstallPromptSection() {
          var section = document.getElementById('installPromptSection');
          section.style.display = 'none';
          console.log('HIDE PWA install prompt');
      }
  </script>
    <script>
      function showInstallPromptSection() {
          var section = document.getElementById('installPromptSection');
          section.style.display = 'block';
          console.log('SHOW PWA install prompt');
      }
  </script>

    <script>
        // Function to update the displayed time
        function updateTime() {
            var currentTime = new Date();
            var hours = currentTime.getHours();
            var minutes = currentTime.getMinutes();
            var seconds = currentTime.getSeconds();
            // Add leading zero if needed
            hours = (hours < 10 ? "0" : "") + hours;
            minutes = (minutes < 10 ? "0" : "") + minutes;
            seconds = (seconds < 10 ? "0" : "") + seconds;
    
            // Display the time in the "localTime" element
            document.getElementById("localTime").innerHTML = hours + ":" + minutes + ":" + seconds;
        }
        // Call updateTime initially when the page loads or is refreshed
        updateTime();
    </script>

<script>
  let deferredPrompt;
  const aboutDialog = document.getElementById("about-dialog");
  const installButton = document.getElementById("install-button");
  var dialogContent = document.querySelector('.dialog-content');
  // Check if the app is already installed (runs when the page loads)
  if (window.matchMedia('(display-mode: standalone)').matches) {
    // hideInstallPromptSection(); //superceded by dialog
    console.log('display-mode = standalone so we are in PWA... NOW do aboutDialog.style.display = none  to make it go away.');
    aboutDialog.style.display = 'none';
  }
  else {
    //aboutDialog.showModal();  //just to see if it works
    console.log('display-mode is NOT standalone so we are online and NOT PWA. Do addListener for beforeinstallprompt then OPEN DIALOG.');
    window.addEventListener('beforeinstallprompt', (event) => {
      // Prevent the default behavior and Stash the event in deferredPrompt so it can be triggered later.
      console.log('beforeinstallprompt RECEIVED');
      event.preventDefault();
      deferredPrompt = event;
      // Show the install button or take any other action  
      //if (deferredPrompt) showInstallPromptSection();  //or leave custom install button hidden & just let the app run on the web?
      if (deferredPrompt) {
        aboutDialog.showModal();
        dialogContent.scrollTop = 0;
        console.log('INSIDE DIALOG & the addEventListener block, the deferred prompt is ', deferredPrompt);
        // Wait for the user to click a dialog cancel/install button.
        aboutDialog.addEventListener('close', () => {
          if (aboutDialog.returnValue === "install") {
            deferredPrompt.prompt();
            console.log('User clicked install....');
            addEventListener('appinstalled', () => {
            console.log('appinstalled event RECEIVED');
            aboutDialog.close();
            console.log('aboutDialog.close called after appinstalled event...  NOW do aboutDialog.style.display = none  to make it go away.');
            aboutDialog.style.display = 'none';
            });
          }
          else {
            installButton.disabled = true;
            console.log('User clicked CANCEL....  aboutDialog return value is ', aboutDialog.returnValue );
            aboutDialog.close();
            console.log('aboutDialog.close called after CANCEL....  NOW do aboutDialog.style.display = none  to make it go away.');
            aboutDialog.style.display = 'none';
          }
        });

      }
    });
  }

</script>

</body>

</html>